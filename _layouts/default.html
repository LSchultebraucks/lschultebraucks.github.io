<!doctype html>
<html>

{% include head.html %}

<body>

  <div class="container">
    {% include header.html %}

    <div class="post-container">
      {{ content }}
    </div>

    {% include footer.html %}

  </div>

  <script>
    (function() {
      function applyIcon() {
        var isDark = document.documentElement.classList.contains('theme-dark');
        var btn = document.getElementById('theme-toggle');
        if (!btn) return;
        // Only set state attributes; icons are handled via CSS based on aria-pressed
        btn.setAttribute('aria-pressed', isDark ? 'true' : 'false');
        btn.title = isDark ? 'Helles Theme aktivieren' : 'Dunkles Theme aktivieren';
      }
      function toggleTheme() {
        var root = document.documentElement;
        var isDark = root.classList.contains('theme-dark');
        var next = isDark ? 'light' : 'dark';
        root.classList.remove('theme-dark','theme-light');
        root.classList.add(next === 'dark' ? 'theme-dark' : 'theme-light');
        try { localStorage.setItem('theme', next); } catch(e) {}
        applyIcon();
      }
      document.addEventListener('DOMContentLoaded', function() {
        var btn = document.getElementById('theme-toggle');
        if (btn) {
          btn.addEventListener('click', toggleTheme);
          applyIcon();
        }
      });
    })();

    // Experience calculation
    (function() {
      function calculateYearsExperience(startDateStr) {
        if (!startDateStr) return null;

        var startDate = new Date(startDateStr);
        var today = new Date();

        var years = today.getFullYear() - startDate.getFullYear();
        var months = today.getMonth() - startDate.getMonth();

        // Adjust if birthday hasn't occurred yet this year
        if (months < 0 || (months === 0 && today.getDate() < startDate.getDate())) {
          years--;
        }

        return years;
      }

      function updateExperienceText() {
        var el = document.getElementById('years-experience');
        if (!el) return;

        var startDate = el.getAttribute('data-start-date');
        var years = calculateYearsExperience(startDate);

        if (years !== null && years > 0) {
          el.textContent = 'over ' + years + ' year' + (years === 1 ? '' : 's');
        }
      }

      // Run on page load
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', updateExperienceText);
      } else {
        updateExperienceText();
      }
    })();
  </script>

</body>
</html>
